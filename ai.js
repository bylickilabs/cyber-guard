/*!
 * BYLICKILABS â€“ AI Monitoring Layer (ai.js)
 * Version: 1.0.1
 *
 * Features:
 *  - Error & Promise Monitoring
 *  - Network Monitoring (fetch + XHR)
 *  - Resource Load Errors
 *  - Performance & FPS Tracking
 *  - Offline Event Queue Marking
 *  - AI Scoring / Anomaly Engine (Errors, Network, Resources, FPS, Performance)
 *  - Local Log Storage (Ring-Buffer)
 *  - Structured Session & Event Telemetry (Session-ID, Event-ID, Snapshots, Breadcrumbs)
 *  - Detailed Protocol Export (JSON, CSV, HTML Report, Session Report)
 *  - Screenshot Export (optional, via html2canvas wenn vorhanden)
 *  - UI-Overlay mit Status & Export-Buttons
 */
!function(e,t){if(!e||!t)return;const r=e.crypto&&e.crypto.randomUUID?e.crypto.randomUUID():"sess-"+Math.random().toString(16).slice(2)+"-"+Date.now().toString(16);let n=0;const o={appName:"AI Monitoring Layer",appVersion:"1.0.1",environment:"production",storageKey:"BYLICKILABS_AI_LOGS",maxLogEntries:800,ui:{enabled:!0,position:"bottom-right"},thresholds:{errorRateHigh:.1,slowLoadMs:3e3,minEventsForAnalysis:20,networkErrorRateWarn:.25,networkErrorRateCrit:.5,resourceErrorWarn:10,resourceErrorCrit:30,fpsWarn:25,fpsCrit:15,fpsWindowSeconds:30}},s={logs:[],session:{id:r,startedAt:null},breadcrumbs:[],counters:{totalEvents:0,errors:0,warnings:0,info:0},performance:{pageLoadTime:null,fpsSamples:[],fpsLastTime:null,fpsAverage:null,fpsLowFrames:0,fpsWindowStart:null,firstAnalysisDone:!1},network:{totalRequests:0,errorCount:0,lastErrors:[],isOffline:!navigator.onLine},resources:{errorCount:0},anomaly:{level:"normal",reasons:[]},initialized:!1};function nowISO(){return(new Date).toISOString()}function safeStringify(e){try{return JSON.stringify(e,null,2)}catch(t){return"{}"}}function persistToStorage(){try{const t=s.logs.slice(-o.maxLogEntries);e.localStorage.setItem(o.storageKey,JSON.stringify(t))}catch(t){}}function createLog(t,r,a,i){const l={timestamp:nowISO(),sessionId:s.session.id,eventId:"evt-"+(++n).toString().padStart(6,"0"),sequence:n,app:o.appName,version:o.appVersion,env:o.environment,type:t,level:r,message:a||"",details:i||{},userAgent:navigator.userAgent||"",url:e.location.href||"",offline:!0===s.network.isOffline};return l.performanceSnapshot={pageLoadTime:s.performance.pageLoadTime,fpsAverage:s.performance.fpsAverage,fpsLowFrames:s.performance.fpsLowFrames},l.networkSnapshot={totalRequests:s.network.totalRequests,errorCount:s.network.errorCount,isOffline:s.network.isOffline},l.resourceSnapshot={errorCount:s.resources.errorCount},l.breadcrumbs=s.breadcrumbs.slice(-25),l}function addLog(e){switch(s.logs.push(e),s.counters.totalEvents++,e.level){case"error":s.counters.errors++;break;case"warn":s.counters.warnings++;break;case"info":s.counters.info++}s.logs.length>o.maxLogEntries&&(s.logs=s.logs.slice(-o.maxLogEntries)),persistToStorage(),runAnomalyAnalysis(),updateUIStatus()}function pushBreadcrumb(e){e&&(s.breadcrumbs.push(e),s.breadcrumbs.length>50&&(s.breadcrumbs=s.breadcrumbs.slice(-50)))}function runAnomalyAnalysis(){const e=[];let t="normal";const r=s.counters.totalEvents||0,n=s.counters.errors||0,a=s.network.totalRequests||0,i=s.network.errorCount||0,l=s.resources.errorCount||0,c=s.performance.fpsAverage,p=s.performance.pageLoadTime;if(r>=o.thresholds.minEventsForAnalysis&&r>0){const s=n/r;s>=2*o.thresholds.errorRateHigh?(t="critical",e.push(`Hohe JS-Fehlerrate: ${(100*s).toFixed(1)}%`)):s>=o.thresholds.errorRateHigh&&("critical"!==t&&(t="warning"),e.push(`ErhÃ¶hte JS-Fehlerrate: ${(100*s).toFixed(1)}%`))}if(null!=p&&(p>2*o.thresholds.slowLoadMs?(t="critical",e.push(`Sehr langsame Page-Load-Zeit: ${p} ms`)):p>o.thresholds.slowLoadMs&&("critical"!==t&&(t="warning"),e.push(`Langsame Page-Load-Zeit: ${p} ms`))),a>0){const r=i/a;r>=o.thresholds.networkErrorRateCrit?(t="critical",e.push(`Hohe Netzwerkfehler-Rate: ${(100*r).toFixed(1)}% (${i}/${a})`)):r>=o.thresholds.networkErrorRateWarn&&("critical"!==t&&(t="warning"),e.push(`ErhÃ¶hte Netzwerkfehler-Rate: ${(100*r).toFixed(1)}% (${i}/${a})`))}if(l>=o.thresholds.resourceErrorCrit?(t="critical",e.push(`Viele fehlgeschlagene Ressourcen-LadevorgÃ¤nge: ${l} Fehler`)):l>=o.thresholds.resourceErrorWarn&&("critical"!==t&&(t="warning"),e.push(`AuffÃ¤llige Anzahl an Ressourcen-Ladefehlern: ${l} Fehler`)),null!=c&&(c<=o.thresholds.fpsCrit?(t="critical",e.push(`Sehr niedrige Rendering-Performance: ~${c.toFixed(1)} FPS`)):c<=o.thresholds.fpsWarn&&("critical"!==t&&(t="warning"),e.push(`Niedrige Rendering-Performance: ~${c.toFixed(1)} FPS`))),s.anomaly.level=t,s.anomaly.reasons=e,!s.performance.firstAnalysisDone&&e.length>0){const r=createLog("anomaly","critical"===t?"error":"warn","AI-Anomaly-Engine hat AuffÃ¤lligkeiten erkannt.",{reasons:e,summary:getAnomalySummary()});s.performance.firstAnalysisDone=!0,s.logs.push(r),s.counters.totalEvents++,s.counters["error"===r.level?"errors":"warnings"]++,persistToStorage()}}function getAnomalySummary(){return{level:s.anomaly.level,reasons:s.anomaly.reasons.slice(),stats:{totalEvents:s.counters.totalEvents,errors:s.counters.errors,warnings:s.counters.warnings,info:s.counters.info,pageLoadTime:s.performance.pageLoadTime,fpsAverage:s.performance.fpsAverage,fpsLowFrames:s.performance.fpsLowFrames,networkTotal:s.network.totalRequests,networkErrors:s.network.errorCount,resourceErrors:s.resources.errorCount,offline:s.network.isOffline,sessionId:s.session.id,sessionStartedAt:s.session.startedAt}}}function captureInitialPerformance(){try{let e=null;if(performance&&performance.getEntriesByType){const t=performance.getEntriesByType("navigation");t&&t.length>0&&(e=Math.round(t[0].duration))}if(!e&&performance&&performance.timing){const t=performance.timing;e=Math.round((t.loadEventEnd||t.domComplete||0)-t.navigationStart)}if(e&&e>0&&e<6e4){s.performance.pageLoadTime=e;addLog(createLog("performance","info","Initiale Page-Load-Messung.",{loadTimeMs:e}))}}catch(e){}}function startFPSTracking(){try{const r=e.performance;if(!r||!r.now||!e.requestAnimationFrame)return;function loop(){try{const e=r.now(),t=e-s.performance.fpsLastTime;if(s.performance.fpsLastTime=e,t>0&&t<1e3){const r=1e3/t;s.performance.fpsSamples.push(r);const n=(e-s.performance.fpsWindowStart)/1e3;if(r<o.thresholds.fpsWarn&&s.performance.fpsLowFrames++,n>=o.thresholds.fpsWindowSeconds){const t=s.performance.fpsSamples;if(t.length>0){const e=t.reduce(((e,t)=>e+t),0);s.performance.fpsAverage=e/t.length}s.performance.fpsSamples=[],s.performance.fpsWindowStart=e;addLog(createLog("performance","info","FPS-Window-Analyse abgeschlossen.",{fpsAverage:s.performance.fpsAverage,fpsLowFrames:s.performance.fpsLowFrames,windowSeconds:o.thresholds.fpsWindowSeconds}))}}}catch(t){}e.requestAnimationFrame(loop)}s.performance.fpsWindowStart=r.now(),s.performance.fpsLastTime=r.now(),e.requestAnimationFrame(loop)}catch(t){}}let a=0;const i=300;function getLogs(){return s.logs.slice()}function clearLogs(){s.logs=[],s.counters.totalEvents=0,s.counters.errors=0,s.counters.warnings=0,s.counters.info=0,s.breadcrumbs=[],persistToStorage(),runAnomalyAnalysis(),updateUIStatus()}function exportLogs(){const e={exportedAt:nowISO(),app:o.appName,version:o.appVersion,env:o.environment,session:{id:s.session.id,startedAt:s.session.startedAt},anomaly:getAnomalySummary(),logs:getLogs()};downloadBlob(JSON.stringify(e,null,2),"application/json","bylickilabs-ai-logs")}function exportIncidentReport(){const e=getAnomalySummary(),t={generatedAt:nowISO(),app:o.appName,version:o.appVersion,env:o.environment,summary:e,lastNetworkErrors:s.network.lastErrors,lastEvents:getLogs().slice(-50)};downloadBlob(JSON.stringify(t,null,2),"application/json","bylickilabs-incident-report")}function exportLogsCsv(){const e=getLogs();if(!e||0===e.length){try{alert("Keine Logs zum Export vorhanden.")}catch(n){}return}const t=["timestamp","sessionId","eventId","sequence","level","type","message","url","offline","details","performanceSnapshot","networkSnapshot","resourceSnapshot","breadcrumbs"],r=e.map((e=>t.map((t=>{let r=e[t];"details"!==t&&"performanceSnapshot"!==t&&"networkSnapshot"!==t&&"resourceSnapshot"!==t&&"breadcrumbs"!==t||(r=null!=r?safeStringify(r):""),null==r&&(r="");return`"${String(r).replace(/"/g,'""')}"`})).join(";")));downloadBlob([t.join(";"),...r].join("\n"),"text/csv","bylickilabs-ai-logs")}function exportHtmlReport(){const e=getAnomalySummary(),t=getLogs().slice(-100);downloadBlob(`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n<meta charset="UTF-8" />\n<title>BYLICKILABS â€“ AI Monitoring Report</title>\n<style>\n    body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; background:#050510; color:#e5e5ff; padding:24px; }\n    h1, h2 { color:#f4f4ff; }\n    .badge { display:inline-block; padding:2px 8px; border-radius:999px; font-size:11px; }\n    .crit { background:rgba(220,30,80,0.18); border:1px solid rgba(255,80,120,0.9); color:#ffd6e0; }\n    .warn { background:rgba(240,180,50,0.18); border:1px solid rgba(255,210,80,0.9); color:#fff4cf; }\n    .ok   { background:rgba(50,200,120,0.18); border:1px solid rgba(50,200,120,0.9); color:#b7f5d2; }\n    pre { background:#0a0a20; padding:12px; border-radius:8px; overflow:auto; max-height:480px; }\n    .meta { margin-bottom:16px; font-size:13px; opacity:0.9; }\n    table { width:100%; border-collapse:collapse; margin-top:12px; font-size:12px; }\n    th, td { border:1px solid rgba(90,90,140,0.5); padding:6px 8px; vertical-align:top; }\n    th { background:#0f0f28; }\n    tr:nth-child(even) td { background:#08081a; }\n</style>\n</head>\n<body>\n    <h1>BYLICKILABS â€“ AI Monitoring Report</h1>\n    <div class="meta">\n        Generated: ${nowISO()}<br/>\n        App: ${o.appName} v${o.appVersion}<br/>\n        Environment: ${o.environment}<br/>\n        Session: ${e.stats.sessionId||""} (started: ${e.stats.sessionStartedAt||""})\n    </div>\n\n    <h2>Summary</h2>\n    <div>\n        Level:\n        ${"critical"===e.level?'<span class="badge crit">CRITICAL</span>':"warning"===e.level?'<span class="badge warn">WARNING</span>':'<span class="badge ok">NORMAL</span>'}\n    </div>\n    <pre>${safeStringify(e)}</pre>\n\n    <h2>Last 100 Events</h2>\n    <table>\n        <thead>\n            <tr>\n                <th>Timestamp</th>\n                <th>Level</th>\n                <th>Type</th>\n                <th>Message</th>\n                <th>Details</th>\n            </tr>\n        </thead>\n        <tbody>\n            ${t.map((e=>`\n                <tr>\n                    <td>${e.timestamp||""}</td>\n                    <td>${e.level||""}</td>\n                    <td>${e.type||""}</td>\n                    <td>${(e.message||"").slice(0,120)}</td>\n                    <td><pre>${safeStringify(e.details||{})}</pre></td>\n                </tr>\n            `)).join("")}\n        </tbody>\n    </table>\n</body>\n</html>\n        `.trim(),"text/html","bylickilabs-ai-report")}function exportSessionReport(){const e=getLogs().filter((e=>e.sessionId===s.session.id)),t={generatedAt:nowISO(),app:o.appName,version:o.appVersion,env:o.environment,session:{id:s.session.id,startedAt:s.session.startedAt,totalLogs:e.length},anomaly:getAnomalySummary(),logs:e};downloadBlob(JSON.stringify(t,null,2),"application/json","bylickilabs-ai-session")}function downloadBlob(e,r,n){try{const o=new Blob([e],{type:r}),s=URL.createObjectURL(o),a=t.createElement("a"),i=(new Date).toISOString().replace(/[:.]/g,"-");a.href=s,a.download=`${n}-${i}`,t.body.appendChild(a),a.click(),t.body.removeChild(a),URL.revokeObjectURL(s)}catch(o){try{console.error("[BYLICKILABS AI] Download fehlgeschlagen:",o)}catch(s){}}}function captureScreenshot(){try{"function"==typeof e.html2canvas?e.html2canvas(t.body).then((function(e){e.toBlob((function(e){if(!e)return;const r=URL.createObjectURL(e),n=t.createElement("a"),o=(new Date).toISOString().replace(/[:.]/g,"-");n.href=r,n.download=`bylickilabs-ai-screenshot-${o}.png`,t.body.appendChild(n),n.click(),t.body.removeChild(n),URL.revokeObjectURL(r)}),"image/png")})):alert("Screenshot-Export benÃ¶tigt 'html2canvas'. Bitte Bibliothek laden oder alternativ Browser-Screenshots verwenden.")}catch(r){try{console.error("[BYLICKILABS AI] Screenshot-Export fehlgeschlagen",r)}catch(n){}}}let l=null,c=null;function createUI(){if(!o.ui.enabled)return;if(!t.body)return;l=t.createElement("div"),l.id="bylickilabs-ai-monitor",l.style.position="fixed",l.style.zIndex="99999",l.style.fontFamily="system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif",l.style.fontSize="12px",l.style.color="#e5e5e5",l.style.background="rgba(10,10,20,0.92)",l.style.borderRadius="10px",l.style.boxShadow="0 0 18px rgba(0,0,0,0.6)",l.style.padding="8px 10px",l.style.minWidth="230px",l.style.backdropFilter="blur(6px)",l.style.border="1px solid rgba(120,120,255,0.45)",l.style.display="flex",l.style.flexDirection="column",l.style.gap="6px","bottom-left"===o.ui.position?(l.style.left="12px",l.style.bottom="12px"):(l.style.right="12px",l.style.bottom="12px");const e=t.createElement("div");e.style.display="flex",e.style.justifyContent="space-between",e.style.alignItems="center",e.style.gap="8px";const r=t.createElement("div");r.textContent="AI Monitoring",r.style.fontWeight="600",r.style.letterSpacing="0.03em",c=t.createElement("span"),c.textContent="NORMAL",c.style.fontSize="10px",c.style.padding="2px 6px",c.style.borderRadius="999px",c.style.background="rgba(50,200,120,0.18)",c.style.border="1px solid rgba(50,200,120,0.65)",c.style.color="#b7f5d2",e.appendChild(r),e.appendChild(c);const n=t.createElement("div");n.style.fontSize="11px",n.style.opacity="0.9",n.innerHTML='<span id="bl-ai-events">Events: 0</span> Â· <span id="bl-ai-errors">Errors: 0</span> Â· <span id="bl-ai-neterr">NetErr: 0</span>';const s=t.createElement("div");s.style.display="flex",s.style.gap="6px",s.style.marginTop="2px";const a=t.createElement("div");a.style.display="flex",a.style.gap="6px";const i=t.createElement("div");function makeButton(e){const r=t.createElement("button");return r.type="button",r.textContent=e,r.style.flex="1",r.style.cursor="pointer",r.style.border="none",r.style.borderRadius="6px",r.style.padding="4px 6px",r.style.fontSize="11px",r.style.background="rgba(80,80,200,0.22)",r.style.color="#f3f3ff",r.style.transition="background 0.15s ease, transform 0.1s ease",r.onmouseenter=function(){r.style.background="rgba(120,120,255,0.38)"},r.onmouseleave=function(){r.style.background="rgba(80,80,200,0.22)",r.style.transform="scale(1.0)"},r.onmousedown=function(){r.style.transform="scale(0.97)"},r.onmouseup=function(){r.style.transform="scale(1.0)"},r}i.style.display="flex",i.style.gap="6px";const p=makeButton("ðŸ“„ JSON");p.addEventListener("click",exportLogs);const d=makeButton("ðŸ“Š CSV");d.addEventListener("click",exportLogsCsv);const u=makeButton("ðŸ“‘ Incident");u.addEventListener("click",exportIncidentReport);const g=makeButton("ðŸ“ HTML");g.addEventListener("click",exportHtmlReport);const f=makeButton("ðŸ“· Shot");f.addEventListener("click",captureScreenshot);const m=makeButton("ðŸ•’ Ses");m.addEventListener("click",exportSessionReport);const h=makeButton("ðŸ§¹ Clear");h.addEventListener("click",clearLogs),s.appendChild(p),s.appendChild(d),a.appendChild(u),a.appendChild(g),i.appendChild(f),i.appendChild(m),i.appendChild(h),l.appendChild(e),l.appendChild(n),l.appendChild(s),l.appendChild(a),l.appendChild(i),t.body.appendChild(l),updateUIStatus()}function updateUIStatus(){if(!l||!c)return;const e=l.querySelector("#bl-ai-events"),t=l.querySelector("#bl-ai-errors"),r=l.querySelector("#bl-ai-neterr");e&&(e.textContent=`Events: ${s.counters.totalEvents}`),t&&(t.textContent=`Errors: ${s.counters.errors}`),r&&(r.textContent=`NetErr: ${s.network.errorCount}`);const n=s.anomaly.level;"critical"===n?(c.textContent="CRITICAL",c.style.background="rgba(220,30,80,0.22)",c.style.border="1px solid rgba(255,80,120,0.8)",c.style.color="#ffd6e0"):"warning"===n?(c.textContent="WARNING",c.style.background="rgba(240,180,50,0.22)",c.style.border="1px solid rgba(255,210,80,0.9)",c.style.color="#fff4cf"):(c.textContent="NORMAL",c.style.background="rgba(50,200,120,0.18)",c.style.border="1px solid rgba(50,200,120,0.65)",c.style.color="#b7f5d2")}function init(){if(s.initialized)return;s.initialized=!0,s.session.startedAt=nowISO(),function loadFromStorage(){try{const t=e.localStorage.getItem(o.storageKey);if(!t)return;const r=JSON.parse(t);Array.isArray(r)&&(s.logs=r,s.counters.totalEvents=r.length,s.counters.errors=r.filter((e=>"error"===e.level)).length,s.counters.warnings=r.filter((e=>"warn"===e.level)).length,s.counters.info=r.filter((e=>"info"===e.level)).length,n=r.length)}catch(t){}}(),function setupErrorMonitoring(){e.addEventListener("error",(function(t){try{if(t.target&&t.target!==e&&t.target.tagName){const e=t.target,r=e.tagName,n=e.src||e.href||"";return s.resources.errorCount++,pushBreadcrumb(`res-error:${r}:${n}`),void addLog(createLog("resource","warn","Ressource konnte nicht geladen werden.",{tag:r,src:n,outerHTML:(e.outerHTML||"").slice(0,300)}))}const r=t.error||{},n={message:t.message||r.message||"",file:t.filename||"",line:t.lineno||null,column:t.colno||null,stack:r.stack||""};pushBreadcrumb(`js-error:${(n.message||"").slice(0,80)}`),addLog(createLog("error","error","Unhandled JavaScript Error.",n))}catch(r){}}),!0),e.addEventListener("unhandledrejection",(function(e){try{const t=e.reason||{},r={message:t.message||safeStringify(t),stack:t.stack||""};pushBreadcrumb(`promise-reject:${(r.message||"").slice(0,80)}`),addLog(createLog("error","error","Unhandled Promise Rejection.",r))}catch(t){}}))}(),function setupEventMonitoring(){t.addEventListener("click",(function(e){try{const t=Date.now();if(t-a<i)return;a=t;const r=e.target||{},n={tag:r.tagName||"",id:r.id||"",classes:r.className||"",textSnippet:(r.innerText||r.textContent||"").slice(0,50)},o=[];if(n.tag&&o.push(n.tag),n.id&&o.push("#"+n.id),n.classes){const e=String(n.classes).split(" ").filter(Boolean).join(".");e&&o.push("."+e)}pushBreadcrumb(`click:${o.join("")}${n.textSnippet?` "${n.textSnippet}"`:""}`),addLog(createLog("event","info","User Click Event.",{element:n}))}catch(t){}}),!0),e.addEventListener("offline",(function(){s.network.isOffline=!0,pushBreadcrumb("system:offline"),addLog(createLog("system","warn","Browser ist offline gegangen.",{}))})),e.addEventListener("online",(function(){s.network.isOffline=!1,pushBreadcrumb("system:online"),addLog(createLog("system","info","Browser ist wieder online.",{}))}))}(),function setupNetworkMonitoring(){try{if(e.fetch){const r=e.fetch;e.fetch=function(){const e=performance&&performance.now?performance.now():Date.now();s.network.totalRequests++;const t=arguments[0],n=arguments[1]&&arguments[1].method||"GET";return r.apply(this,arguments).then((function(t){const r=(performance&&performance.now?performance.now():Date.now())-e;if(!t.ok){s.network.errorCount++;const e={url:t.url,status:t.status,statusText:t.statusText,durationMs:Math.round(r),method:n};pushBreadcrumb(`net-error:${t.status}:${t.url}`),addLog(createLog("network","warn","HTTP-Fehler bei fetch().",e)),s.network.lastErrors.push({timestamp:nowISO(),...e}),s.network.lastErrors.length>20&&(s.network.lastErrors=s.network.lastErrors.slice(-20))}return t}))["catch"]((function(e){s.network.errorCount++;const r={message:e&&e.message?e.message:String(e),stack:e&&e.stack?e.stack:"",requestInfo:t,method:n};throw pushBreadcrumb(`net-fail:${(r.message||"").slice(0,60)}`),addLog(createLog("network","error","fetch() ist mit einem Netzwerkfehler fehlgeschlagen.",r)),s.network.lastErrors.push({timestamp:nowISO(),error:r.message,method:n,requestInfo:t}),s.network.lastErrors.length>20&&(s.network.lastErrors=s.network.lastErrors.slice(-20)),e}))}}if(e.XMLHttpRequest){const n=e.XMLHttpRequest;function WrappedXHR(){const e=new n;let t="",r="GET",o=null;const a=e.open;e.open=function(n,o){return r=n||"GET",t=o||"",a.apply(e,arguments)};const i=e.send;return e.send=function(){return s.network.totalRequests++,o=performance&&performance.now?performance.now():Date.now(),e.addEventListener("loadend",(function(){try{const n=(performance&&performance.now?performance.now():Date.now())-o;if(e.status>=400||0===e.status){s.network.errorCount++;const o={url:t,status:e.status,statusText:e.statusText,method:r,durationMs:Math.round(n)};pushBreadcrumb(`xhr-error:${e.status}:${t}`),addLog(createLog("network","warn","HTTP-Fehler bei XMLHttpRequest.",o)),s.network.lastErrors.push({timestamp:nowISO(),...o}),s.network.lastErrors.length>20&&(s.network.lastErrors=s.network.lastErrors.slice(-20))}}catch(n){}})),i.apply(e,arguments)},e}e.XMLHttpRequest=WrappedXHR}}catch(t){}}(),"complete"===t.readyState?(captureInitialPerformance(),startFPSTracking(),createUI()):e.addEventListener("load",(function(){captureInitialPerformance(),startFPSTracking(),createUI()}));addLog(createLog("system","info","BYLICKILABS AI Monitoring v1.0.1 initialisiert.",{config:{appName:o.appName,env:o.environment}}))}const p={config:o,init:init,getLogs:getLogs,clearLogs:clearLogs,exportLogs:exportLogs,exportLogsCsv:exportLogsCsv,exportIncidentReport:exportIncidentReport,exportHtmlReport:exportHtmlReport,exportSessionReport:exportSessionReport,captureScreenshot:captureScreenshot,getAnomalySummary:getAnomalySummary,logCustom:function(e,t,r){addLog(createLog("custom",e||"info",t||"",r||{}))}};e.BYLICKILABS_AI_MONITOR=p,init()}(window,document);
